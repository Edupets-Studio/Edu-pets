<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tu mascota</title>
  <style>
    :root {
      --azul-claro: #cfe8ff;
      --azul: #7dbef5;
      --verde-claro: #dafbe1;
      --amarillo-claro: #fff9dc;
      --rosado-suave: #edf3fa;
      --texto: #333;
      --fuente: 'Segoe UI', sans-serif;
    }

    body {
      margin: 0;
      font-family: var(--fuente);
      background-color: var(--amarillo-claro);
      font-size: 20px;
      color: var(--texto);
    }

    .contenedor {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    .panel {
      width: 300px;
      padding: 30px;
      box-sizing: border-box;
      position: absolute;
      height: 100%;
      top: 0;
      z-index: 2;
      transition: opacity 0.5s ease;
      opacity: 0;
      pointer-events: none;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      border-radius: 0 16px 16px 0;
    }

    .panel.izquierda {
      left: 0;
      background: linear-gradient(180deg, var(--azul-claro), var(--azul));
      color: white;
    }

    .panel.derecha {
      right: 0;
      background-color: var(--verde-claro);
    }

    .panel.activa {
      opacity: 1;
      pointer-events: auto;
    }

    .contenido {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 1;
      background-color: var(--rosado-suave);
    }

    .toggle {
      position: absolute;
      top: 10px;
      font-size: 30px;
      background-color: #ffffff;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      cursor: pointer;
      z-index: 3;
      transition: transform 0.3s ease;
      font-weight: bold;
    }

    .toggle:hover {
      transform: scale(1.1);
    }

    #toggle-izquierda { left: 10px; }
    #toggle-derecha { right: 10px; }

    .necesidades {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
      gap: 40px;
    }

    .necesidad-container {
      text-align: center;
    }

    .necesidad {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      margin: 0 auto;
      border: 5px solid white;
      transition: 0.3s;
      box-shadow: 0 6px 15px rgba(0,0,0,0.15);
    }

    .porcentaje {
      margin-top: 10px;
      font-weight: bold;
      font-size: 22px;
    }

    .nombre-mascota {
      font-size: 24px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    #editar-nombre {
      font-size: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    .pinguino {
      width: 200px;
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      animation: flotar 3s ease-in-out infinite;
    }

    @keyframes flotar {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }

    .botones {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 30px;
    }

    .botones button {
      font-size: 30px;
      padding: 15px 25px;
      background-color: var(--verde-claro);
      border: none;
      border-radius: 15px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      transition: 0.3s ease;
      font-weight: bold;
    }

    .botones button:hover {
      background-color: #c4efd3;
      transform: scale(1.05);
    }

    .barra-edicion {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #d4fcd4;
      padding: 15px 20px;
      border-radius: 15px;
      display: flex;
      justify-content: center;
      gap: 10px;
      align-items: center;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.2);
      font-size: 20px;
      z-index: 5;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.4s ease;
    }

    .barra-edicion.activa {
      opacity: 1;
      visibility: visible;
    }

    .barra-edicion input {
      font-size: 18px;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #aaa;
      width: 200px;
    }

    .barra-edicion button {
      font-size: 18px;
      padding: 8px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .barra-edicion .aceptar {
      background-color: #7be77b;
    }

    .barra-edicion .cancelar {
      background-color: #ffb3b3;
    }

    h3 {
      margin-top: 0;
      font-size: 26px;
    }

    .volver {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background-color: #f8bcbc;
      border: 2px solid #000;
      border-radius: 50%;
      text-align: center;
      line-height: 55px;
      font-size: 0.9em;
      font-weight: bold;
      cursor: pointer;
      text-decoration: none;
      color: black;
    }

    .bienvenida {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #c8facc;
      color: #333;
      font-size: 18px;
      font-weight: bold;
      padding: 15px 25px;
      border-radius: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }

    .bienvenida.mostrar {
      opacity: 1;
    }
  </style>
</head>
<body>

  <div id="bienvenida" class="bienvenida">
    Esta es tu mascota virtual. Deber√°s cuidarla por medio de divertidos ejercicios matem√°ticos. ¬°Cu√≠dala bien!
  </div>

  <div id="toggle-izquierda" class="toggle">üìò</div>
  <div id="toggle-derecha" class="toggle">üìê</div>

  <div class="contenedor">
    <div class="panel izquierda lista-tareas" id="panel-izquierda">
      <h3>Lista de tareas</h3>
      <p>Realiza una tarea de suma para darle a tu mascota de comer</p>
    </div>

    <a class="volver" href="javascript:history.back()">Volver</a>

    <div class="contenido">
      <div class="necesidades" id="necesidades-container">
        <div class="necesidad-container">
          <div class="porcentaje" id="porcentaje-comida">100%</div>
          <div class="necesidad" id="comida" style="background-image: url('imagenes/comida.png');"></div>
        </div>
        <div class="necesidad-container">
          <div class="porcentaje" id="porcentaje-sue√±o">100%</div>
          <div class="necesidad" id="sue√±o" style="background-image: url('imagenes/sue√±o.png');"></div>
        </div>
        <div class="necesidad-container">
          <div class="porcentaje" id="porcentaje-felicidad">100%</div>
          <div class="necesidad" id="felicidad" style="background-image: url('imagenes/felicidad.png');"></div>
        </div>
      </div>

      <div class="nombre-mascota">
        <span id="titulo-mascota">Tu mascota: <span id="nombre-mascota">Katy</span></span>
        <button id="editar-nombre">‚úèÔ∏è</button>
      </div>

      <img src="imagenes/pet.jpeg" alt="Pinguino" class="pinguino">
    </div>

    <div class="panel derecha" id="panel-derecha">
      <h3>Operaciones</h3>
      <div class="botones">
        <button onclick="irAEjercicio('ejercicio1.html')">+</button>
        <button onclick="irAEjercicio('ejercicio2.html')">‚àí</button>
        <button onclick="irAEjercicio('ejercicio3.html')">√ó</button>
      </div>
    </div>
  </div>

  <div class="barra-edicion" id="barra-edicion">
    <input type="text" id="nuevo-nombre" placeholder="Nuevo nombre..." />
    <button class="aceptar" id="btn-aceptar">‚úÖ Aceptar</button>
    <button class="cancelar" id="btn-cancelar">‚ùå Cancelar</button>
  </div>

  <script>
    const necesidades = [
      { id: 'comida', porcentajeId: 'porcentaje-comida' },
      { id: 'sue√±o', porcentajeId: 'porcentaje-sue√±o' },
      { id: 'felicidad', porcentajeId: 'porcentaje-felicidad' }
    ];

    function getSavedEstado() {
      return JSON.parse(localStorage.getItem('estadoMascota')) || {
        comida: { valor: 100, timestamp: Date.now() },
        sue√±o: { valor: 100, timestamp: Date.now() },
        felicidad: { valor: 100, timestamp: Date.now() }
      };
    }

    function saveEstado(estado) {
      localStorage.setItem('estadoMascota', JSON.stringify(estado));
    }

    function actualizarColor(porcentaje, elem) {
      if (porcentaje > 59) elem.style.backgroundColor = 'green';
      else if (porcentaje > 29) elem.style.backgroundColor = 'yellow';
      else elem.style.backgroundColor = 'red';
    }

    function iniciarNecesidades() {
      const estado = getSavedEstado();
      const ahora = Date.now();

      necesidades.forEach(n => {
        const obj = estado[n.id];
        const elem = document.getElementById(n.id);
        const label = document.getElementById(n.porcentajeId);

        const segundosPasados = Math.floor((ahora - obj.timestamp) / 1000);
        const unidadesPerdidas = Math.floor(segundosPasados / 9);
        let nuevoValor = Math.max(0, obj.valor - unidadesPerdidas);

        obj.valor = nuevoValor;
        obj.timestamp = ahora;

        label.textContent = nuevoValor + '%';
        actualizarColor(nuevoValor, elem);

        setInterval(() => {
          obj.valor = Math.max(0, obj.valor - 1);
          obj.timestamp = Date.now();
          label.textContent = obj.valor + '%';
          actualizarColor(obj.valor, elem);
          saveEstado(estado);
        }, 9000);
      });

      saveEstado(estado);
    }

    function incrementarOrbes() {
      const estado = getSavedEstado();
      const ahora = Date.now();
      for (const key in estado) {
        estado[key].valor = Math.min(100, estado[key].valor + 40);
        estado[key].timestamp = ahora;
      }
      saveEstado(estado);
    }

    function irAEjercicio(url) {
      incrementarOrbes();
      setTimeout(() => {
        window.location.href = url;
      }, 100);
    }

    function cargarNombreMascota() {
      const nombre = localStorage.getItem('nombreMascota') || 'Ping√ºi';
      document.getElementById('nombre-mascota').textContent = nombre;
    }

    const barra = document.getElementById('barra-edicion');
    document.getElementById('editar-nombre').addEventListener('click', () => {
      const input = document.getElementById('nuevo-nombre');
      input.value = document.getElementById('nombre-mascota').textContent;
      barra.classList.add('activa');
    });

    document.getElementById('btn-cancelar').addEventListener('click', () => {
      barra.classList.remove('activa');
    });

    document.getElementById('btn-aceptar').addEventListener('click', () => {
      const nuevoNombre = document.getElementById('nuevo-nombre').value.trim();
      if (nuevoNombre !== '') {
        localStorage.setItem('nombreMascota', nuevoNombre);
        document.getElementById('nombre-mascota').textContent = nuevoNombre;
      }
      barra.classList.remove('activa');
    });

    document.getElementById('toggle-izquierda').addEventListener('click', () => {
      document.getElementById('panel-izquierda').classList.toggle('activa');
    });

    document.getElementById('toggle-derecha').addEventListener('click', () => {
      document.getElementById('panel-derecha').classList.toggle('activa');
    });

    window.onload = () => {
      iniciarNecesidades();
      cargarNombreMascota();
      const bienvenida = document.getElementById('bienvenida');
      bienvenida.classList.add('mostrar');
      setTimeout(() => {
        bienvenida.classList.remove('mostrar');
      }, 15000);
    };
  </script>
</body>
</html>

